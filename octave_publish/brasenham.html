<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>A visualization of Bresenham&#39;s line algorithm</title>
  <meta name="description" content="This short story is about working with raster graphics, especially how to draw one of the most basic geometric shapes with them: a line. Of course one might ...">

  <link rel="stylesheet" href="/assets/main.css">
  <link rel="canonical" href="https://siko1056.github.io/octave_publish/brasenham.html">
  <link rel="alternate" type="application/rss+xml" title="siko1056&#39;s website" href="/feed.xml">

  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] },
    TeX: { equationNumbers: { autoNumber: 'all' } }
  });
  </script>
  <script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script>
</head>


  <body>

    <header class="site-header" role="banner">

  <div class="wrapper">

    <a class="site-title" href="/">
      <svg height="32" class="octicon octicon-home" viewBox="0 0 16 16" version="1.1" width="32" aria-hidden="true"><path fill-rule="evenodd" d="M16 9l-3-3V2h-2v2L8 1 0 9h2l1 5c0 .55.45 1 1 1h8c.55 0 1-.45 1-1l1-5h2zm-4 5H9v-4H7v4H4L2.81 7.69 8 2.5l5.19 5.19L12 14z"/></svg>
    </a>

    <nav class="site-nav">
      <span class="menu-icon">
        <svg viewBox="0 0 18 15" width="18px" height="15px">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </span>

      <div class="trigger">
        
          
          <a class="page-link" href="/about.html">About</a>
          
        
          
          <a class="page-link" href="/blog.html">Blog</a>
          
        
          
        
          
        
          
          <a class="page-link" href="/references.html">BibTeX</a>
          
        
          
        
          
        
      </div>
    </nav>

  </div>

</header>


    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">A visualization of Bresenham&#39;s line algorithm</h1>
    <p class="post-meta"><time datetime="2016-12-13T00:00:00+01:00" itemprop="datePublished">Dec 13, 2016</time></p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <p>This short story is about working with raster graphics, especially how to
draw one of the most basic geometric shapes with them: a line.  Of course one
might complain, that this is understood for many years and even GNU Octave
provides many high-level plotting routines like <a href="https://www.gnu.org/software/octave/doc/interpreter/XREFplot.html">plot</a>, etc.</p>

<p>I challenged this task with same biased attitude and had to find out that it
is more difficult than expected, if one doesn’t know the
<a href="https://en.wikipedia.org/wiki/Bresenham's_line_algorithm">line algorithm</a> of
<a href="https://en.wikipedia.org/wiki/Jack_Elton_Bresenham">Bresenham</a> from 1962.
This line algorithm can easily be extended to
<a href="https://en.wikipedia.org/wiki/Midpoint_circle_algorithm">draw ellipses</a>
therefore it is highly beneficial to understand it properly.  Especially,
if no such graphic libraries aren’t around in your environment.</p>


<p>The only algorithm input are the coordinates of a line that should be drawn
from some pixel $(x_{0},y_{0})$ to $(x_{1},y_{1})$.  No certain order of
these points is required, just that both are contained in the image raster,
what should be 	self-explanatory.</p>

<figure class="highlight"><pre><code class="language-octave" data-lang="octave"><span class="n">x0</span> <span class="p">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="n">y0</span> <span class="p">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="n">x1</span> <span class="p">=</span> <span class="mi">15</span><span class="p">;</span>
<span class="n">y1</span> <span class="p">=</span> <span class="mi">8</span><span class="p">;</span></code></pre></figure>

<p>Before the algorithm starts, it it possible to compute some values in
advance that do not change.  For example the horizontal and  vertical
projections, $dx$ and $dy$, respectively.  The first one is defined to be
positive and the latter one negative.</p>

<figure class="highlight"><pre><code class="language-octave" data-lang="octave"><span class="n">dx</span>  <span class="p">=</span> <span class="n">int32</span> <span class="p">(</span> <span class="nb">abs</span> <span class="p">(</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span><span class="p">));</span>
<span class="n">dy</span>  <span class="p">=</span> <span class="n">int32</span> <span class="p">(</span><span class="o">-</span><span class="nb">abs</span> <span class="p">(</span><span class="n">y1</span> <span class="o">-</span> <span class="n">y0</span><span class="p">));</span></code></pre></figure>

<p>As the result is a raster graphic, all quantities should be integer values.
Therefore Octave requires some type conversion to <a href="https://www.gnu.org/software/octave/doc/interpreter/XREFint32.html">int32</a>, as
the default datatype is the IEEE-754 double precision floating point number.</p>

<p>To handle arbitrary aligned lines, the signs $(sx,sy)$ of the endpoint
difference serve as step in the respective direction.</p>

<figure class="highlight"><pre><code class="language-octave" data-lang="octave"><span class="n">sx</span>  <span class="p">=</span> <span class="n">int32</span> <span class="p">(</span><span class="nb">sign</span> <span class="p">(</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span><span class="p">));</span>
<span class="n">sy</span>  <span class="p">=</span> <span class="n">int32</span> <span class="p">(</span><span class="nb">sign</span> <span class="p">(</span><span class="n">y1</span> <span class="o">-</span> <span class="n">y0</span><span class="p">));</span></code></pre></figure>

<p>Now comes the most important part of the algorithm: the error quantity.
As mentioned before, having opposite signs for $dx$ and $dy$ makes it
easy to determine from a single value if there is a step in X-, Y-, or
both directions necessary.  In one sentence: if <code>err</code> grows too fast in
either direction $\pm$, hence the risk for not reaching the targeted
coordinate grows, the “path” is corrected by omitting one or more steps in
the too fast growing direction (see the right graphic below and the
explanation).</p>

<figure class="highlight"><pre><code class="language-octave" data-lang="octave"><span class="n">err</span> <span class="p">=</span> <span class="n">dx</span> <span class="o">+</span> <span class="n">dy</span><span class="p">;</span></code></pre></figure>

<p>The running variables $x$ and $y$ have to be of integer type and take the
values of start point $(x_{0},y_{0})$.</p>

<figure class="highlight"><pre><code class="language-octave" data-lang="octave"><span class="n">x</span> <span class="p">=</span> <span class="n">int32</span> <span class="p">(</span><span class="n">x0</span><span class="p">);</span>
<span class="n">y</span> <span class="p">=</span> <span class="n">int32</span> <span class="p">(</span><span class="n">y0</span><span class="p">);</span></code></pre></figure>

<p>Perform some graphics setup and start the main loop of the line
algorithm.</p>

<figure class="highlight"><pre><code class="language-octave" data-lang="octave"><span class="nb">close</span> <span class="nb">all</span><span class="p">;</span>
<span class="nb">clc</span><span class="p">;</span>
<span class="n">h1</span> <span class="p">=</span> <span class="nb">subplot</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="nb">plot</span> <span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="p">[</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">,</span> <span class="p">[</span><span class="n">y0</span><span class="p">,</span> <span class="n">y1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">);</span>
<span class="nb">axis</span> <span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="s">&#39;equal&#39;</span><span class="p">);</span>
<span class="nb">hold</span> <span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="s">&#39;on&#39;</span><span class="p">);</span>
<span class="nb">grid</span> <span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="s">&#39;on&#39;</span><span class="p">);</span>
<span class="n">h2</span> <span class="p">=</span> <span class="nb">subplot</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
<span class="nb">bar</span> <span class="p">(</span><span class="n">h2</span><span class="p">,</span> <span class="p">[</span><span class="n">dx</span><span class="p">,</span> <span class="nb">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="o">-</span><span class="n">dy</span><span class="p">))],</span> <span class="s">&#39;r&#39;</span><span class="p">);</span>
<span class="nb">axis</span> <span class="p">(</span><span class="n">h2</span><span class="p">,</span> <span class="s">&#39;equal&#39;</span><span class="p">);</span>
<span class="nb">hold</span> <span class="p">(</span><span class="n">h2</span><span class="p">,</span> <span class="s">&#39;on&#39;</span><span class="p">);</span>
<span class="nb">ylabel</span> <span class="p">(</span><span class="n">h2</span><span class="p">,</span> <span class="s">&#39;X-direction   &lt;== No step ==&gt;   Y-direction.&#39;</span><span class="p">);</span>
<span class="nb">bar</span> <span class="p">(</span><span class="n">h2</span><span class="p">,</span> <span class="p">[</span><span class="n">dy</span><span class="p">,</span> <span class="nb">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="o">-</span><span class="n">dy</span><span class="p">))],</span> <span class="s">&#39;r&#39;</span><span class="p">);</span>
<span class="n">setPixel</span> <span class="p">=</span> <span class="p">@(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="n">rectangle</span> <span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="s">&#39;Position&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s">&#39;FaceColor&#39;</span><span class="p">,</span> <span class="s">&#39;r&#39;</span><span class="p">);</span>
<span class="n">i</span> <span class="p">=</span> <span class="mi">1</span><span class="p">;</span>

<span class="c">%</span>
<span class="c">% Main loop of the actual line algorithm.</span>
<span class="c">%</span>

<span class="n">setPixel</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
<span class="k">while</span> <span class="p">(</span><span class="n">x</span> <span class="o">~=</span> <span class="n">int32</span> <span class="p">(</span><span class="n">x1</span><span class="p">)</span> <span class="o">||</span> <span class="n">y</span> <span class="o">~=</span> <span class="n">int32</span> <span class="p">(</span><span class="n">y1</span><span class="p">))</span>
  <span class="n">e2</span> <span class="p">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">err</span><span class="p">;</span>

  <span class="c">% These three lines don&#39;t belong to the algorithm</span>
  <span class="nb">bar</span> <span class="p">(</span><span class="n">h2</span><span class="p">,</span> <span class="p">[</span><span class="nb">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="n">e2</span><span class="p">],</span> <span class="s">&#39;b&#39;</span><span class="p">);</span>
  <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="c">%kbhit (); % uncomment for interactivity</span>

  <span class="k">if</span> <span class="p">(</span><span class="n">e2</span> <span class="o">&gt;</span> <span class="n">dy</span><span class="p">)</span>
    <span class="n">err</span> <span class="o">+=</span> <span class="n">dy</span><span class="p">;</span>
    <span class="n">x</span>   <span class="o">+=</span> <span class="n">sx</span><span class="p">;</span>
  <span class="k">endif</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">dx</span> <span class="o">&gt;</span> <span class="n">e2</span><span class="p">)</span>
    <span class="n">err</span> <span class="o">+=</span> <span class="n">dx</span><span class="p">;</span>
    <span class="n">y</span>   <span class="o">+=</span> <span class="n">sy</span><span class="p">;</span>
  <span class="k">endif</span>
  <span class="n">setPixel</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
<span class="k">endwhile</span></code></pre></figure>

<p><img src="/src/octave/html/brasenham-1.png" alt="/src/octave/html/brasenham-1.png" />
The code above can be run interactively, if the respective line using
<a href="https://www.gnu.org/software/octave/doc/interpreter/XREFkbhit.html">kbhit</a> is uncommented.  Some final words to the graphics.
The right graphic shows in red squared the resulting pixels for approximating
the line within a coarse, but human perceivable, raster.  The choice of
these pixels is not natural on the first sight, but seen from some distance,
it looks like a reasonable line within that raster.</p>

<p>The decision when not to step upwards becomes clear, when inspecting the
error quantity in the right image.  Naturally, the line algorithm wants
to go one step up and one step right to reach the target pixel.  The step
in Y-direction is omitted when the blue bar <code>e2</code> exceeds the red bar <code>dx</code>
in positive direction (in the main loop the condition <code>(dx &gt; e2)</code> is violated
then).  Analogue for the X-direction, if the blue bar <code>e2</code> exceeds the red
bar <code>dy</code> in negative direction.</p>

<p>In the given example, roughly speaking, every second blue bar exceeds the
red bar, thus the resulting pixel pattern occurs in the right image.</p>

<p>This type of error correction happens for the ellipse in a similar way.
Therefore if one understands the line drawing a solid technique for drawing
ellipses even without external graphic libraries is understood.</p>

<p>Published with GNU Octave 4.2.0</p>

  </div>

  
</article>

      </div>
    </main>

    <footer class="site-footer">

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li>
            
              Kai Torben Ohlhus
            
            </li>
            
            <li><a href="mailto:k.ohlhus@gmail.com">k.ohlhus@gmail.com</a></li>
            
        </ul>
      </div>

      <div class="footer-col footer-col-2">
        <ul class="social-media-list">
          <li>
            <a href="https://github.com/siko1056"><span class="icon icon--github"><svg viewBox="0 0 16 16" width="16px" height="16px"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span><span class="username">siko1056</span></a>

          </li>
        </ul>
      </div>

      <div class="footer-col footer-col-3">
        <a rel="license" href="http://creativecommons.org/licenses/by-nd/4.0/">
          <img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nd/4.0/88x31.png">
        </a>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
